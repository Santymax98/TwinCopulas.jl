<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Elliptical Copulas · TwinCopulas.jl</title><meta name="title" content="Elliptical Copulas · TwinCopulas.jl"/><meta property="og:title" content="Elliptical Copulas · TwinCopulas.jl"/><meta property="twitter:title" content="Elliptical Copulas · TwinCopulas.jl"/><meta name="description" content="Documentation for TwinCopulas.jl."/><meta property="og:description" content="Documentation for TwinCopulas.jl."/><meta property="twitter:description" content="Documentation for TwinCopulas.jl."/><meta property="og:url" content="https://Santymax98.github.io/TwinCopulas.jl/Elliptical/Elliptical_theory/"/><meta property="twitter:url" content="https://Santymax98.github.io/TwinCopulas.jl/Elliptical/Elliptical_theory/"/><link rel="canonical" href="https://Santymax98.github.io/TwinCopulas.jl/Elliptical/Elliptical_theory/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TwinCopulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../../">TwinCopulas</a></li><li><a class="tocitem" href="../../starting/">Getting Started</a></li></ul></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../../Copula_Sklar/">Getting starting</a></li><li><a class="tocitem" href="../../Archimedean/Archimedean_theory/">Archimedean Copulas</a></li><li class="is-active"><a class="tocitem" href>Elliptical Copulas</a><ul class="internal"><li><a class="tocitem" href="#Sampling-for-Bivariate-Elliptical-Copulas"><span>Sampling for Bivariate Elliptical Copulas</span></a></li></ul></li><li><a class="tocitem" href="../../Extreme/Extreme_Value_theory/">Extreme Value Copulas</a></li></ul></li><li><span class="tocitem">Available Models</span><ul><li><a class="tocitem" href="../../Archimedean/Avaliable_Archimedean_models/">Archimedean Copulas</a></li><li><a class="tocitem" href="../Avaliable_Elliptical_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../Extreme/Avaliable_Extreme_models/">Extreme Value Copulas</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Elliptical Copulas</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Elliptical Copulas</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Santymax98/TwinCopulas.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Santymax98/TwinCopulas.jl/blob/main/docs/src/Elliptical/Elliptical_theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Elliptical_theory"><a class="docs-heading-anchor" href="#Elliptical_theory">Elliptical Copulas</a><a id="Elliptical_theory-1"></a><a class="docs-heading-anchor-permalink" href="#Elliptical_theory" title="Permalink"></a></h1><p>An <em>Elliptical Copula</em> is defined as the copula of the related elliptical distribution <span>$F$</span>. Its analytical form is obtained via <em>Sklar&#39;s theorem</em> from the distribution function <span>$F$</span>. A copula <span>$C$</span> is an <em>Elliptical Copula</em> if it has the functional form <span>$C(u_1, u_2) = F(F_1^{-1}(u_1), F_2^{-1}(u_2)), \quad u_1, u_2 \in [0, 1]^2,$</span> where <span>$F_k^{-1}$</span> are the univariate quantile functions, <span>$k=1,2$</span>.</p><p><em>Elliptical copulas</em> are widely used and well-documented in the literature due to their unique characteristics, such as their ability to model symmetric dependencies and their flexibility in capturing various dependency structures. Unlike extreme value copulas and Archimedean copulas, elliptical copulas do not have a closed-form expression, making them distinct in their formulation and application.</p><p>Two well-known examples of elliptical copulas are the Gaussian copula and the t copula. These copulas are particularly important due to their widespread use in finance and risk management:</p><blockquote><p><strong>Bivariate Gaussian Copula</strong>: The bivariate normal or Gaussian copula <span>$C_{gaussian}$</span> is the copula of <span>$(X, Y) \sim \mathcal{N}_2(0, P),$</span> where <span>$P$</span> is a correlation matrix. The functional form is obtained by <span>$C_{Gaussian}(u_1,u_2)=\Phi_2(\Phi^{-1}(u_1),\Phi^{-1}(u_2)), \quad u_1,u_2 \in [0,1]^2,$</span> where <span>$\Phi_2$</span> is the joint distribution function of <span>$(X,Y),$</span> and <span>$\Phi^{-1}$</span> is the quantile function of the univariate standard normal distribution.</p></blockquote><blockquote><p><strong>Bivariate t Copula</strong>: The bivariate <span>$t$</span>-Copula <span>$C_{t,\nu}$</span> is the copula of <span>$(X,Y)\sim t_2(0,P,\nu),$</span> where <span>$P$</span> is a correlation matrix. The analytical form is obtained by <span>$C_{t,\nu}(u_1,u_2)=t_{2,\nu}(t_{\nu}^{-1}(u_1),t_{\nu}^{-1}(u_2)), \quad u_1,u_2 \in [0,1]^2,$</span> where <span>$t_{2,\nu}$</span> is the joint distribution function of <span>$(X,Y)$</span> and <span>$t_{\nu}^{-1}$</span> is the quantile function of the univariate standar <span>$t$</span>-distribution with <span>$\nu$</span> degrees of freedom.</p></blockquote><p>Elliptical copulas, including the Gaussian and t copulas, are powerful tools for modeling dependencies between variables, particularly when the dependency structure is symmetric and not overly influenced by tail behavior.</p><p>In this package, there is an abstract type [<code>EllipticalCopula</code>] that provides a foundation for defining elliptical copulas. The Gaussian and t copulas are already implemented for you! You can utils these as follow</p><pre><code class="language-Julia hljs">julia&gt; G = GaussianCopula(0.8)
GaussianCopula{Float64}(θ=0.8) #Gaussian Copula with param 0.8

julia&gt; T = tCopula(2, -0.3)
tCopula{Int64, Float64}(θ=-0.3, ν=2) #t Copula with 2 degree of freedom and param -0.3</code></pre><p>You may want to use an elliptical copula customized for your needs. TwinCopulas allows the implementation of your own elliptic copula. You can implement it in the following way</p><pre><code class="language-julia hljs">struct MyEllipticalCopula{P} &lt;: EllipticalCopula{P}
    θ::P #param o params need for created a correlation matrix
end</code></pre><p>In this way you create a structure of your copula and you can implement the <code>CDF</code>, <code>PDF</code> or whatever functions you want following the conventions used in this package</p><pre><code class="language-Julia hljs">function Distributions.cdf(C::MyEllipticalCopula, x::AbstractVector)
    cdf_value = #Implement the specific cdf of your copula
    return cdf_value
end

function Distributions.pdf(C::MyElliptical, x::AbstractVector)
    pdf_value = #Implement the specific pdf of your copula
    return pdf_value
end</code></pre><h2 id="Sampling-for-Bivariate-Elliptical-Copulas"><a class="docs-heading-anchor" href="#Sampling-for-Bivariate-Elliptical-Copulas">Sampling for Bivariate Elliptical Copulas</a><a id="Sampling-for-Bivariate-Elliptical-Copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-for-Bivariate-Elliptical-Copulas" title="Permalink"></a></h2><p>In the same way as in other classes of domes, to generate samples of a Gaussian copula we can use the conditional method, you only need the first derivative of the copula function, however in many cases this can be complex. You could use ForwardDiff for an approximation.</p><p>In <em>TwinCopulas</em> we use specific methods for each elliptical copula. Below we detail these algorithms.</p><h3 id="Simulating-the-Gaussian-Copula"><a class="docs-heading-anchor" href="#Simulating-the-Gaussian-Copula">Simulating the Gaussian Copula</a><a id="Simulating-the-Gaussian-Copula-1"></a><a class="docs-heading-anchor-permalink" href="#Simulating-the-Gaussian-Copula" title="Permalink"></a></h3><p>Imput the bivariate Gaussian Copula with param <span>$\theta$</span>.</p><blockquote><p><em>(1)</em> We form the correlation matrix \Sigma = \begin{pmatrix}</p></blockquote><p>1.0 &amp; \theta\  \theta &amp; 1.0 \end{pmatrix}$ for the bivariate case.</p><blockquote><p><em>(2)</em> Compute the Cholesky descomposition of <span>$\Sigma,$</span> providing a lower triangular matrix <span>$A,$</span> satisfying <span>$AA&#39;=\Sigma$</span></p><p><em>(3)</em> Simulate <span>$Y_1, Y_2 \sim \mathcal{N}(0,1)$</span></p><p><em>(4)</em> Compute the random vector $\begin{pmatrix}</p></blockquote><p>X<em>1\  X</em>2 \end{pmatrix}=A\cdot \begin{pmatrix} Y<em>1\  Y</em>2 \end{pmatrix}$</p><blockquote><p>which has bivariate normal distribution with zero mean vector, unit variances, and correlation matrix <span>$\Sigma$</span></p><p><em>(5)</em> Return <span>$(U_1, U_2),$</span> where <span>$U_i=\Phi(X_i), i=1,2,$</span> where  <span>$\Phi$</span> is the CDF of standard normal distribution.</p></blockquote><h3 id="Simulating-the-Gaussian-Copula-2"><a class="docs-heading-anchor" href="#Simulating-the-Gaussian-Copula-2">Simulating the Gaussian Copula</a><a class="docs-heading-anchor-permalink" href="#Simulating-the-Gaussian-Copula-2" title="Permalink"></a></h3><p>Imput the bivariate <span>$t$</span>-Copula with params <span>$(\nu,\theta)$</span>.</p><blockquote><p><em>(1)</em> We form the correlation matrix \Sigma = \begin{pmatrix}</p></blockquote><p>1.0 &amp; \theta\  \theta &amp; 1.0 \end{pmatrix}$ for the bivariate case.</p><blockquote><p><em>(2)</em> Compute the Cholesky descomposition of <span>$\Sigma,$</span> providing a lower triangular matrix <span>$A,$</span> satisfying <span>$AA&#39;=\Sigma$</span></p><p><em>(3)</em> Simulate <span>$Y_1, Y_2 \sim \mathcal{N}(0,1)$</span> and simulate a rando variable <span>$W\sim inv\Gamma(\frac{\nu}{2}, \frac{\nu}{2})$</span></p><p><em>(4)</em> Compute the random vector $\begin{pmatrix}</p></blockquote><p>X<em>1\  X</em>2 \end{pmatrix}=\sqrt{W}A\cdot \begin{pmatrix} Y<em>1\  Y</em>2 \end{pmatrix}$</p><blockquote><p><em>(5)</em> Return <span>$(U_1, U_2),$</span> where <span>$U_i=t_{\nu}(X_i), i=1,2,$</span> where  <span>$t_{\nu}$</span> is the CDF of standard <span>$t$</span>-distribution.</p></blockquote></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Archimedean/Archimedean_theory/">« Archimedean Copulas</a><a class="docs-footer-nextpage" href="../../Extreme/Extreme_Value_theory/">Extreme Value Copulas »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 25 July 2024 13:24">Thursday 25 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
