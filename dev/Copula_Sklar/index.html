<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Getting starting · TwinCopulas.jl</title><meta name="title" content="Getting starting · TwinCopulas.jl"/><meta property="og:title" content="Getting starting · TwinCopulas.jl"/><meta property="twitter:title" content="Getting starting · TwinCopulas.jl"/><meta name="description" content="Documentation for TwinCopulas.jl."/><meta property="og:description" content="Documentation for TwinCopulas.jl."/><meta property="twitter:description" content="Documentation for TwinCopulas.jl."/><meta property="og:url" content="https://Santymax98.github.io/TwinCopulas.jl/Copula_Sklar/"/><meta property="twitter:url" content="https://Santymax98.github.io/TwinCopulas.jl/Copula_Sklar/"/><link rel="canonical" href="https://Santymax98.github.io/TwinCopulas.jl/Copula_Sklar/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TwinCopulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../">TwinCopulas</a></li><li><a class="tocitem" href="../starting/">Getting Started</a></li></ul></li><li><span class="tocitem">Guide</span><ul><li class="is-active"><a class="tocitem" href>Getting starting</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Sklar&#39;s-Theorem"><span>Sklar&#39;s Theorem</span></a></li><li class="toplevel"><a class="tocitem" href="#Survival-Copulas"><span>Survival Copulas</span></a></li><li><a class="tocitem" href="#Definition-of-the-Bivariate-Survival-Function"><span>Definition of the Bivariate Survival Function</span></a></li><li><a class="tocitem" href="#Marginal-Survival-Functions"><span>Marginal Survival Functions</span></a></li><li><a class="tocitem" href="#Relationship-to-Sklar&#39;s-Theorem"><span>Relationship to Sklar&#39;s Theorem</span></a></li><li><a class="tocitem" href="#Survival-Analog-of-Sklar&#39;s-Theorem"><span>Survival Analog of Sklar&#39;s Theorem</span></a></li><li class="toplevel"><a class="tocitem" href="#Conditional-Sampling-for-Bivariate-Copulas"><span>Conditional Sampling for Bivariate Copulas</span></a></li></ul></li><li><a class="tocitem" href="../Archimedean/Archimedean_theory/">Archimedean Copulas</a></li><li><a class="tocitem" href="../Elliptical/Elliptical_theory/">Elliptical Copulas</a></li><li><a class="tocitem" href="../Extreme/Extreme_Value_theory/">Extreme Value Copulas</a></li></ul></li><li><span class="tocitem">Available Models</span><ul><li><a class="tocitem" href="../Archimedean/Avaliable_Archimedean_models/">Archimedean Copulas</a></li><li><a class="tocitem" href="../Elliptical/Avaliable_Elliptical_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../Extreme/Avaliable_Extreme_models/">Extreme Value Copulas</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Getting starting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Getting starting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Santymax98/TwinCopulas.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Santymax98/TwinCopulas.jl/blob/main/docs/src/Copula_Sklar.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Copulas"><a class="docs-heading-anchor" href="#Copulas">Copulas</a><a id="Copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Copulas" title="Permalink"></a></h1><p>The law of 2-dimensional random vector <span>$X = (X_1, X_2)$</span> defined on a probability space <span>$(\Omega, \mathcal{F}, \mathbb{P}),$</span> is usually studied from its <em>distribution function</em></p><p class="math-container">\[F(x_1,x_2)= \mathbb{P}(X_1 \leq x_2, X_2 \leq x_2), \hspace{0.5cm} x_1, x_2 \in \mathbb{R}.\]</p><p>For <span>$i = 1,2$</span> the distribution function <span>$F_i$</span> of <span>$X_i$</span> is called the (univariate) <em>marginal law</em> or <em>margin</em> and be retrieved from <span>$F$</span> via</p><p class="math-container">\[F_i(x_i) = \mathbb{P}(X_i \leq x_i)=F(x_i,\infty), \hspace{0.5cm} x_i \in \mathbb{R}.\]</p><p>It is important to note that knowing the marginal distributions <span>$F_1, F_2$</span> is not sufficient to determine the joint distribution <span>$F.$</span> Additionally, it is required to understand how the marginal distributions are coupled. This is achieved by means of a <em>copula</em> of <span>$(X_1, X_2).$</span> Generally speaking, knowing the margins and a copula is equivalent to knowing the joint distribution. It is now appropriate to provide the definition of a copula.</p><blockquote><p><strong>Definition (Copula):</strong>  </p><p><em>(1)</em> A function <span>$C: [0, 1]^2 \to [0, 1]$</span> is called a <em>bivariate copula</em>, if there is a probability space <span>$(\Omega, \mathcal{F}, \mathbb{P})$</span> supporting a random vector <span>$(U_1, U_2)$</span> such that <span>$U_k \sim \mathcal{U}[0,1]$</span> for all <span>$k=1,2$</span> and</p><p class="math-container">\[C(u_1,u_2)=\mathbb{P}(U_1 \leq u_1, U_2 \leq u_2), \hspace{0.5 cm} u_1, u_2 \in [0, 1].\]</p><p><em>(2)</em> On a probability space <span>$(\Omega, \mathcal{F}, \mathbb{P})$</span> let <span>$(U_1, U_2)$</span> be a random vector on <span>$[0,1]^2$</span> whose joint distribution function is a copula</p><p class="math-container">\[C: [0,1]^2 \to [0,1].\]</p></blockquote><pre><code class="language-julia hljs">using Distributions, TwinCopulas
θ = 0.5 # Parameter
G = GaussianCopula(θ) # A 2-dimensional Gaussian Copula with parameter θ = 0.5.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GaussianCopula{Float64}(θ=0.5)</code></pre><p>This object is a random vector, and behaves exactly as you would expect a random vector from Distributions.jl to behave: you may sample it with rand(C,100), compute its pdf or cdf with pdf(C,x) and cdf(C,x), etc:</p><pre><code class="language-julia hljs">u = rand(G, 10)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×10 Matrix{Float64}:
 0.648623  0.893893  0.544757  0.406215  …  0.590071  0.495195  0.109276
 0.625541  0.511484  0.868601  0.162346     0.940224  0.86512   0.237462</code></pre><pre><code class="language-julia hljs">v = [0.5, 0.6]
cdf(G, v)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.3804363762931904</code></pre><blockquote><p><strong>Example (Independent Copula)</strong>  </p><p>The function <span>$\Pi: [0,1]^2 \to [0,1],$</span> given by <span>$\Pi(u_1, u_2)=u_1u_2, \hspace{0.5 cm} u_1,u_2 \in [0,1],$</span> is called the <em>Independence Copula.</em></p></blockquote><blockquote><p><strong>Example (Fréchet-Hoeffding bounds)</strong></p><p>The Fréchet-Hoeffding bounds represent the extreme cases of dependence for a copula. These bounds are given by the following functions:</p><ul><li><strong>Lower Fréchet-Hoeffding bound</strong>:$</li></ul></blockquote><p>W(u<em>1, u</em>2) = \max{u<em>1 + u</em>2 - 1, 0}$</p><blockquote><ul><li><strong>Upper Fréchet-Hoeffding bound</strong>:<span>$M(u_1, u_2) = \min\{u_1, u_2\}$</span></li></ul></blockquote><p>These limits can be viewed as the extreme cases of dependence in a copula:</p><ul><li>The <strong>lower bound</strong> <span>$W(u_1, u_2)$</span> corresponds to the case of the most negative dependence, where the variables are perfectly anti-monotonic. This means that if one variable increases, the other decreases in a perfectly predictable manner.</li><li>The <strong>upper bound</strong> <span>$M(u_1, u_2)$</span> corresponds to the case of the most positive dependence, where the variables are perfectly monotonic. This means that if one variable increases, the other also increases in a perfectly predictable manner.</li></ul><p>These bounds provide a way to understand the range of possible dependence structures that can be modeled by a copula, from complete negative dependence to complete positive dependence.</p><p>The syntax to use these copulas in TwinCopulas is the following:</p><pre><code class="language-julia hljs">using TwinCopulas
I = IndependentCopula() # A 2-dimensional Independent Copula.
M = MCopula() # A 2-dimensional upper bound.
W = WCopula() # A 2-dimensional lower bound.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">WCopula()</code></pre><h1 id="Sklar&#39;s-Theorem"><a class="docs-heading-anchor" href="#Sklar&#39;s-Theorem">Sklar&#39;s Theorem</a><a id="Sklar&#39;s-Theorem-1"></a><a class="docs-heading-anchor-permalink" href="#Sklar&#39;s-Theorem" title="Permalink"></a></h1><p>In probability theory and statistics, Sklar&#39;s Theorem is a fundamental result that connects multivariate distribution functions to their marginal distributions through a copula. This theorem provides a powerful framework for modeling and analyzing the dependence structure between random variables.</p><p><strong>Sklar&#39;s Theorem:</strong> Let <span>$F$</span> a 2-dimensional distribution function with margins <span>$F_1,F_2$</span>. Then there exist a 2-dimensional copula <span>$C$</span> such that for all <span>$(x_1,x_2) \in \mathbb{R}^2$</span> it holds that  <span>$F(x_1, x_2)=C(F_1(x_1),F_2(x_2)).$</span>   If <span>$F_1, F_2$</span> are continuous, then <span>$C$</span> is unique. Conversely, if <span>$C$</span> is a 2-dimensional copula and <span>$F_1, F_2$</span> are univariate distribution functions, then he function <span>$F$</span> is a 2-dimensional distribution function [<code>sklar1959</code>].</p><p>Sklar&#39;s Theorem is significant because it allows us to separate the marginal behavior of each variable from their dependence structure. The marginal distributions <span>$F_1$</span> and <span>$F_2$</span> describe the individual behavior of the random variables, while the copula <span>$C$</span> captures how these variables are related to each other.</p><p>This separation is particularly useful in various applications:</p><ol><li><p><strong>Modeling Flexibility</strong>: By using copulas, we can model complex dependencies between variables while maintaining flexibility in choosing different marginal distributions. This is especially valuable in fields like finance, insurance, and risk management, where understanding dependencies between risks is crucial.</p></li><li><p><strong>Dependence Structure</strong>: Copulas provide a way to quantify and visualize the dependence structure between variables, which is not possible by looking at marginals alone. This helps in understanding the nature and strength of the relationships between variables.</p></li><li><p><strong>Simulation and Sampling</strong>: Sklar&#39;s Theorem facilitates the generation of multivariate data with specified marginals and dependence structures. This is useful for simulations and scenarios where realistic modeling of dependencies is required.</p></li></ol><p>In summary, Sklar&#39;s Theorem is a cornerstone in the field of copula theory, enabling the decoupling of marginal distributions and dependence structures, and providing a versatile tool for statistical modeling and analysis of multivariate data.</p><p>The syntax for generating bivariate distributions with Sklar&#39;s theorem is as follows:</p><pre><code class="language-julia hljs">using TwinCopulas, Distributions
margins = [Normal(), Beta(3.5, 2.3)]
copula = ClaytonCopula(3.5)
F = SklarDist(copula, margins)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SklarDist{ClaytonCopula{Float64}, Tuple{Distributions.Normal{Float64}, Distributions.Beta{Float64}}}(
copula: ClaytonCopula{Float64}(θ=3.5)
margins: (Distributions.Normal{Float64}(μ=0.0, σ=1.0), Distributions.Beta{Float64}(α=3.5, β=2.3))
)
</code></pre><h1 id="Survival-Copulas"><a class="docs-heading-anchor" href="#Survival-Copulas">Survival Copulas</a><a id="Survival-Copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Survival-Copulas" title="Permalink"></a></h1><p>In some cases, it is more convenient to describe the distribution of a random vector <span>$(X_1, X_2)$</span> using its survival function instead of its distribution function, especially when the components <span>$X_1$</span> and <span>$X_2$</span> are interpreted as lifetimes. The survival function provides a more intuitive description in such contexts.</p><h2 id="Definition-of-the-Bivariate-Survival-Function"><a class="docs-heading-anchor" href="#Definition-of-the-Bivariate-Survival-Function">Definition of the Bivariate Survival Function</a><a id="Definition-of-the-Bivariate-Survival-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Definition-of-the-Bivariate-Survival-Function" title="Permalink"></a></h2><p>For a bivariate random vector <span>$(X_1, X_2)$</span> defined on a probability space <span>$(\Omega, \mathcal{F}, \mathbb{P})$</span>, the survival function <span>$\overline{F}$</span> is defined as:</p><p class="math-container">\[\overline{F}(x_1, x_2) := \mathbb{P}(X_1 &gt; x_1, X_2 &gt; x_2), \quad x_1, x_2 \in \mathbb{R}.\]</p><h2 id="Marginal-Survival-Functions"><a class="docs-heading-anchor" href="#Marginal-Survival-Functions">Marginal Survival Functions</a><a id="Marginal-Survival-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Marginal-Survival-Functions" title="Permalink"></a></h2><p>For <span>$i = 1, 2$</span>, the univariate marginal survival function <span>$\overline{F}_i$</span> of <span>$X_i$</span> can be retrieved from the bivariate survival function <span>$\overline{F}$</span> as follows:</p><p class="math-container">\[\overline{F}_i(x_i) = \mathbb{P}(X_i &gt; x_i) = \overline{F}(x_i, -\infty) \quad \text{for} \; i = 1, \; \text{and} \; \overline{F}_i(x_i) = \overline{F}(-\infty, x_i) \quad \text{for} \; i = 2, \quad x_i \in \mathbb{R}.\]</p><h2 id="Relationship-to-Sklar&#39;s-Theorem"><a class="docs-heading-anchor" href="#Relationship-to-Sklar&#39;s-Theorem">Relationship to Sklar&#39;s Theorem</a><a id="Relationship-to-Sklar&#39;s-Theorem-1"></a><a class="docs-heading-anchor-permalink" href="#Relationship-to-Sklar&#39;s-Theorem" title="Permalink"></a></h2><p>Analogous to Sklar&#39;s Theorem for distribution functions, the survival function of a bivariate random vector can be decomposed into a copula and its marginal survival functions. This decomposition allows for a more nuanced understanding of the dependence structure between the variables.</p><h2 id="Survival-Analog-of-Sklar&#39;s-Theorem"><a class="docs-heading-anchor" href="#Survival-Analog-of-Sklar&#39;s-Theorem">Survival Analog of Sklar&#39;s Theorem</a><a id="Survival-Analog-of-Sklar&#39;s-Theorem-1"></a><a class="docs-heading-anchor-permalink" href="#Survival-Analog-of-Sklar&#39;s-Theorem" title="Permalink"></a></h2><p>Let <span>$\overline{F}$</span> be a bivariate survival function with marginal survival functions <span>$\overline{F}_1$</span> and <span>$\overline{F}_2$</span>. Then there exists a bivariate copula <span>$\overline{C}$</span> such that for all <span>$(x_1, x_2) \in \mathbb{R}^2$</span>, the following holds:</p><p class="math-container">\[\overline{F}(x_1, x_2) = \overline{C}(\overline{F}_1(x_1), \overline{F}_2(x_2)).\]</p><p>If the marginal survival functions <span>$\overline{F}_1$</span> and <span>$\overline{F}_2$</span> are continuous, then the copula <span>$\overline{C}$</span> is unique. Conversely, if <span>$\overline{C}$</span> is a bivariate copula and <span>$\overline{F}_1$</span> and <span>$\overline{F}_2$</span> are univariate survival functions, then the function <span>$\overline{F}$</span> is a bivariate survival function.</p><p>The survival copula approach is particularly useful in reliability theory and survival analysis, where it is common to deal with the lifetimes of components or systems. The survival function provides a direct way to model the joint survival probabilities, and the survival copula captures the dependence structure between these lifetimes. This method allows for a clearer interpretation and more effective modeling of the joint behavior of the variables involved.</p><p>By utilizing survival copulas, one can effectively separate the marginal survival characteristics of each variable from their dependence structure, leading to a more flexible and comprehensive approach to multivariate survival analysis.</p><p>The syntax to use the survival copula in TwinCopulas is the following:</p><pre><code class="language-julia hljs">using TwinCopulas
cop = GumbelCopula(5.5)
S = SurvivalCopula(cop)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SurvivalCopula{GumbelCopula{Float64}}(
C: GumbelCopula{Float64}(θ=5.5)
)
</code></pre><h1 id="Conditional-Sampling-for-Bivariate-Copulas"><a class="docs-heading-anchor" href="#Conditional-Sampling-for-Bivariate-Copulas">Conditional Sampling for Bivariate Copulas</a><a id="Conditional-Sampling-for-Bivariate-Copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-Sampling-for-Bivariate-Copulas" title="Permalink"></a></h1><p>As the main sampling method, TwinCopulas implements conditional sampling based on a bivariate probability space, supporting two iid random variables. This algorithm is not restricted to any specific class of copulas, making it versatile for sampling arbitrary bivariate copulas. The only challenging step is calculating the partial derivative and its generalized inverse, which usually requires a well-defined analytical form of the copula and is not easy to obtain.</p><p>The imput for the algorithm is a bivariate copula <span>$C: [0,1]^2 \to [0,1].$</span></p><blockquote><p><strong>Algotithm 1</strong></p><p><em>(1)</em> Simulate <span>$U_2 \sim \mathcal{U}[0,1]$</span></p><p><em>(2)</em> Compute (the right continuous version of) the function <span>$F_{U_1|U_2}(u_1)=\frac{\partial}{\partial u_2}C(u_1,u_2)|_{u_2=U_2}, \quad u_2 \in [0,1].$</span> <em>(3)</em> Compute de generalized inverse of <span>$F_{U_1|U_2},$</span> i.e <span>$F^{-1}_{U_1|U_2}(v)=\inf\{u_1 &gt; 0: F_{U_1|U_2}(u_1)\geq v\}, \quad v \in [0,1].$</span>  <em>(4)</em> Simulate <span>$V \sim \mathcal{U}[0,1],$</span> independent of <span>$U_2.$</span></p><p><em>(5)</em> Set <span>$U_1 = F^{-1}_{U_1|U_2}(V)$</span> and return <span>$(U_1, U_2).$</span></p></blockquote></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../starting/">« Getting Started</a><a class="docs-footer-nextpage" href="../Archimedean/Archimedean_theory/">Archimedean Copulas »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 25 July 2024 13:32">Thursday 25 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
