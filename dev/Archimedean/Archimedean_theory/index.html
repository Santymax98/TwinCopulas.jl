<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Archimedean Copulas ¬∑ TwinCopulas.jl</title><meta name="title" content="Archimedean Copulas ¬∑ TwinCopulas.jl"/><meta property="og:title" content="Archimedean Copulas ¬∑ TwinCopulas.jl"/><meta property="twitter:title" content="Archimedean Copulas ¬∑ TwinCopulas.jl"/><meta name="description" content="Documentation for TwinCopulas.jl."/><meta property="og:description" content="Documentation for TwinCopulas.jl."/><meta property="twitter:description" content="Documentation for TwinCopulas.jl."/><meta property="og:url" content="https://Santymax98.github.io/TwinCopulas.jl/Archimedean/Archimedean_theory/"/><meta property="twitter:url" content="https://Santymax98.github.io/TwinCopulas.jl/Archimedean/Archimedean_theory/"/><link rel="canonical" href="https://Santymax98.github.io/TwinCopulas.jl/Archimedean/Archimedean_theory/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TwinCopulas.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../../">TwinCopulas</a></li><li><a class="tocitem" href="../../starting/">Getting Started</a></li></ul></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../../Copula_Sklar/">Getting starting</a></li><li class="is-active"><a class="tocitem" href>Archimedean Copulas</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Advanced-Concepts"><span>Advanced Concepts</span></a></li><li><a class="tocitem" href="#Radial-Distribution"><span>Radial Distribution</span></a></li></ul></li><li><a class="tocitem" href="../../Elliptical/Elliptical_theory/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../Extreme/Extreme_Value_theory/">Extreme Value Copulas</a></li></ul></li><li><span class="tocitem">Available Models</span><ul><li><a class="tocitem" href="../Avaliable_Archimedean_models/">Archimedean Copulas</a></li><li><a class="tocitem" href="../../Elliptical/Avaliable_Elliptical_models/">Elliptical Copulas</a></li><li><a class="tocitem" href="../../Extreme/Avaliable_Extreme_models/">Extreme Value Copulas</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Archimedean Copulas</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Archimedean Copulas</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Santymax98/TwinCopulas.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Santymax98/TwinCopulas.jl/blob/main/docs/src/Archimedean/Archimedean_theory.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Archimedean_theory"><a class="docs-heading-anchor" href="#Archimedean_theory">Archimedean Copulas</a><a id="Archimedean_theory-1"></a><a class="docs-heading-anchor-permalink" href="#Archimedean_theory" title="Permalink"></a></h1><p><em>Archimedean copulas</em> are one of the most popular families within this field due to two fundamental characteristics: they have a closed and straightforward algebraic expression, and they exhibit a high level of symmetry. A copula <span>$C_\varphi$</span>, is an <em>Archimedean copula</em> if it has the functional form <span>$C_\varphi(u_1, u_2) = \varphi(\varphi^{-1}(u_1) + \varphi^{-1}(u_2)),$</span> where <span>$\varphi$</span> is a continuous, strictly non-increasing function <span>$\varphi: [0, \infty) \to [0, 1],$</span> with <span>$\varphi(0)=1$</span> and <span>$\lim_{x \to \infty}\varphi(x)=0,$</span> called the <em>Archimedean generator</em>.</p><p>In the context of bivariate Archimedean copulas, the generator <span>$\varphi$</span> must also be completely monotone to ensure that <span>$C_\varphi$</span> is a valid copula. A function <span>$\varphi$</span> is said to be completely monotone if it satisfies <span>$(-1)^k \varphi^{(k)}(x) \ge 0$</span> for all <span>$x \ge 0$</span> and for all <span>$k \ge 0$</span>. This property guarantees that the corresponding copula exhibits appropriate dependency structures. To construct such generators, we can use the Williamson transform, which provides a method to generate completely monotone functions suitable for Archimedean copulas.</p><blockquote><p><strong>Definition (d-monotony [mcneil2009]):</strong> A function <span>$\varphi$</span> is said to be <span>$d$</span>-monotone if it has <span>$d-2$</span> derivatives which satisfy </p><p class="math-container">\[(-1)^k \varphi^{(k)}(x) \ge 0 \;\forall k \in \{0, 1, \ldots, d-2\},\]</p><p>and if <span>$(-1)^{d-2}\varphi^{(d-2)}(x)$</span> is a non-increasing and convex function. </p><p>A function that is <span>$d$</span>-monotone for all <span>$d$</span> is called <strong>completely monotone</strong>.</p></blockquote><p>In the particular case when (d = 2), a function <span>$\varphi$</span> is 2-monotone if it satisfies:</p><ul><li><p class="math-container">\[\varphi(x) \ge 0\]</p></li><li><p class="math-container">\[\varphi&#39;(x) \le 0\]</p>(i.e., <span>$\varphi$</span> is non-increasing)</li><li><p class="math-container">\[\varphi&#39;&#39;(x) \ge 0\]</p>(i.e., <span>$\varphi&#39;$</span> is non-decreasing and convex)</li></ul><p>Therefore, a function that is 2-monotone is a non-increasing, convex function.</p><p>To summarize, a function <span>$\varphi$</span> that is 2-monotone must be non-increasing and convex. If <span>$\varphi$</span> is <span>$d$</span>-monotone for all <span>$d$</span>, it is called <strong>completely monotone</strong>.</p><p>In this package, there is an abstract type [<code>ArchimedeanCopula</code>] that provides a foundation for defining Archimedean copulas. Many Archimedean copulas are already implemented for you! See [the list of implemented Archimedean copulas] to get an overview.</p><p>If you do not find the one you need, you may define it yourself by subtyping <code>ArchimedeanCopula</code>. The API does not require much information, which is really convenient. Only the following methods are required:</p><ul><li>ùòô(C::ArchimedeanCopula) =</li><li>œï(C::ArchimedeanCopula, x) = </li><li>œï‚Åª¬π(C::ArchimedeanCopula, x) =</li></ul><p>That is, the Archimedean generator, its inverse, and its respective radial function. With the above, you can define a new copula in this package as follows: </p><pre><code class="language-julia hljs">struct MyArchimedeanCopula{P} &lt;: ArchimedeanCopula{P}
    Œ∏::P
end

ùòô(C::MyArchimedeanCopula) = 1
œï(C::MyArchimedeanCopula, x) = exp(-x)
œï‚Åª¬π(C::MyArchimedeanCopula, x) = -log(x)</code></pre><p>It is not difficult to see that in this case <span>$C_\varphi = \prod,$</span> showing that the independence copula <span>$\prod$</span> is included in the Archimedean Family.</p><div class="admonition is-info"><header class="admonition-header">Nomenclature information</header><div class="admonition-body"><p>We have called <code>ùòô()</code> the radial distribution, which is necessary for sampling a bivariate Archimedean copula. The letter we use is <code>\isansR</code>. In this document, we use <span>$\varphi$</span>, but in code, we use <code>\phi</code>.</p></div></div><h1 id="Advanced-Concepts"><a class="docs-heading-anchor" href="#Advanced-Concepts">Advanced Concepts</a><a id="Advanced-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Concepts" title="Permalink"></a></h1><p>Here, we present some important concepts of the theory of Archimedean copulas.</p><h2 id="Radial-Distribution"><a class="docs-heading-anchor" href="#Radial-Distribution">Radial Distribution</a><a id="Radial-Distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Radial-Distribution" title="Permalink"></a></h2><p>The radial distribution, denoted as <span>$ùòô(\cdot)$</span>, is essential for generating samples from a bivariate Archimedean copula. It represents the distribution of the radial part of the copula and can be used to obtain the dependent structure between the two variables. The radial distribution is a key component in the sampling process and is used to generate the joint distribution from the marginal distributions.</p><p>For the class of Archimedean copulas, we propose three different algorithms to generate samples from a copula.</p><h3 id="Conditional-Sampling-for-Bivariate-Archimedean-Copulas"><a class="docs-heading-anchor" href="#Conditional-Sampling-for-Bivariate-Archimedean-Copulas">Conditional Sampling for Bivariate Archimedean Copulas</a><a id="Conditional-Sampling-for-Bivariate-Archimedean-Copulas-1"></a><a class="docs-heading-anchor-permalink" href="#Conditional-Sampling-for-Bivariate-Archimedean-Copulas" title="Permalink"></a></h3><p>To use this sampling method, we define the radial distribution as 1. This is represented in Julia as:</p><pre><code class="language-Julia hljs">ùòô(C::ArchimedeanCopula) = 1</code></pre><p>When this is defined, TwinCopulas uses Algorithm 1, introduced in [reference], to sample from the copula and its derivative as follows. We adapt Algorithm 1 from [reference] for the case of bivariate Archimedean copulas. The input for the algorithm is a bivariate archimedean copula <span>$C: [0,1]^2 \to [0,1].$</span></p><blockquote><p><strong>Algotithm 1: Bivariate Archimedean Copulas</strong></p><p><em>(1)</em> Simulate <span>$U_2 \sim \mathcal{U}[0,1]$</span></p><p><em>(2)</em> Compute (the right continuous version of) the function <span>$F_{U_1|U_2}(u_1)=\frac{\partial}{\partial u_2}C(u_1,u_2)=\varphi&#39;(\varphi^{-1}(u_1)+\varphi^{-1}(u_2))\varphi^{-1&#39;}(u_2), \quad u_2 \in [0,1].$</span> <em>(3)</em> Compute de generalized inverse of <span>$F_{U_1|U_2},$</span> i.e <span>$F^{-1}_{U_1|U_2}(v)=\inf\{u_1 &gt; 0: F_{U_1|U_2}(u_1)\geq v\}, \quad v \in [0,1].$</span>  <em>(4)</em> Simulate <span>$V \sim \mathcal{U}[0,1],$</span> independent of <span>$U_2.$</span></p><p><em>(5)</em> Set <span>$U_1 = F^{-1}_{U_1|U_2}(V)$</span> and return <span>$(U_1, U_2).$</span></p></blockquote><h3 id="Sampling-from-Archimedean-Copula-Using-Frailty-Distribution"><a class="docs-heading-anchor" href="#Sampling-from-Archimedean-Copula-Using-Frailty-Distribution">Sampling from Archimedean Copula Using Frailty Distribution</a><a id="Sampling-from-Archimedean-Copula-Using-Frailty-Distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-from-Archimedean-Copula-Using-Frailty-Distribution" title="Permalink"></a></h3><h3 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h3><p>Here is a detailed algorithm for sampling from an Archimedean copula using the frailty distribution:</p><blockquote><p><strong>Algorithm 2: Sampling from Archimedean Copula Using Frailty Distribution</strong></p><p><em>(1)</em> Sample a positive random variable <span>$W$</span> with Laplace transform (Know Radial Distribution) <span>$\varphi.$</span></p><p><em>(2)</em> Sample a random variable <span>$Z \sim Erlang(2, 1)$</span> and compute <span>$R=\frac{Z}{W}$</span> </p><p><em>(3)</em> Sample i.i.d <span>$E_1, E_2,$</span> where <span>$E_k \sim Exp(1),$</span> and compute <span>$S_k=\frac{E_k}{E_1+E_2}, \ \ k = 1,2.$</span> </p><p><em>(4)</em> Return <span>$(U_1, U_2)$</span> where <span>$U_k=\varphi(RS_k), \ \ k=1,2.$</span></p></blockquote><p>By using the frailty distribution approach, the algorithm ensures accurate and efficient sampling from the Archimedean copula, maintaining the desired dependence structure. For the copulas such that AMH, Clayton, Frank, Gumbel and Joe the literature shows its corresponding radial distribution.</p><pre><code class="language-Julia hljs">ùòô(C::GumbelCopula) = Stable(1 / C.Œ∏)</code></pre><h3 id="Sampling-from-Archimedean-Copula-Using-Williamson-Transform"><a class="docs-heading-anchor" href="#Sampling-from-Archimedean-Copula-Using-Williamson-Transform">Sampling from Archimedean Copula Using Williamson Transform</a><a id="Sampling-from-Archimedean-Copula-Using-Williamson-Transform-1"></a><a class="docs-heading-anchor-permalink" href="#Sampling-from-Archimedean-Copula-Using-Williamson-Transform" title="Permalink"></a></h3><p>In many cases the radial distribution is not kwon, in this case [<code>Mcneil</code>] solves this problem using the concept of d-monote generator together with the Williamson Transform.</p><p><strong>Definition (Williamson 2-Transform [mcneil2009]):</strong> The <em>Williamson 2-Transform</em> of a positive random variable <span>$R$</span> is defined as <span>$\frak{W}_2F(R) = \mathbb{E}[\max(1-\frac{r}{R},0)], \ \ r \geq 0.$</span></p><p>Furthermore, the distribution function <span>$F_R$</span> of a postive random variable <span>$R$</span> is completely characterized by Williamson transform of <span>$\varphi$</span> archimedean generator by <span>$\frak{W}_2^{-1}\varphi.$</span> That is <span>$F_R(r)=1-\varphi(r)+r\varphi&#39;(r).$</span></p><p>This is sufficient to obtain the radial distribution necessary to obtain samples of a bivariate archimedean copula. This is very beneficial if you do not kwon the specific radial distribution for a bivariate archimedean copula. Follow the algorithm for this case:</p><blockquote><p><strong>Algorithm 3: Sampling from Archimedean Copula Using the Williamson 2-Transform</strong></p><p><em>(1)</em> Sample a positive random variable <span>$R\sim F(R)$</span> where <span>$F(R)=\frak{W}_2^{-1}\varphi$</span>.$</p><p><em>(2)</em> Sample i.i.d <span>$E_1, E_2,$</span> where <span>$E_k \sim Exp(1),$</span> and compute <span>$S_k=\frac{E_k}{E_1+E_2}, \ \ k = 1,2.$</span> </p><p><em>(3)</em> Return <span>$(U_1, U_2)$</span> where <span>$U_k=\varphi(RS_k), \ \ k=1,2.$</span></p></blockquote><pre><code class="language-Julia hljs">ùòô(C::MyArchimedeanCopula) = RadialDist(C.Œ∏)</code></pre><p>We tested this implementation using <code>Nelsen2Copula</code> from TwinCopulas, this corresponds to copula number 2 from table 4.1 of Nelsen (2006). It works well for certain values of the parameter, for other cases there are numerical problems when obtaining the inverse distribution. We need more test to be able to generalize this function. For more details you can see [<code>Nelsen</code>]. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Copula_Sklar/">¬´ Getting starting</a><a class="docs-footer-nextpage" href="../../Elliptical/Elliptical_theory/">Elliptical Copulas ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 25 July 2024 13:49">Thursday 25 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
